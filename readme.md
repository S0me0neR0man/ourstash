# NoSQL in-memory БД

## Зачем
Легковесная БД с минимальными требованиями к настройке и конфигурированию, при этом:
* Многопользовательская
* История изменений
* Опциональный контроль версий  

## Общий подход
Данные хранятся в виде `ключ`-`значение` </br>
Уровнем выше следующая логическая структура:
- БД состоит из секций (далекая аналогия - таблицы реляционной БД), секция 0 системная
- В каждой секции множество записей (ид записи - автоинкремент `uint64`). Нулевая запись системная.
- Для каждой записи хранится история изменений (при создании генерируется guid, update создает новую запись с тем же
guid, старая запись помечается как удаленная + в заголовке сохраняется ид новой записи)
- Запись состоит из произвольного набора полей. Пользовательский идентификатор поля `string`, внутренний ид `uint16`.
Внутренние идентификаторы создаются один раз и никогда не изменяются.
- Для быстрого поиска реализовано `redBlackTree`. Публичные методы потокобезопасные. 
- Для секции можно включить версионность на уровне записей 

## Хранение данных
```
const KeyLength = 16
type Key [keyLength]byte
```

| секция</br> [0:1] </br> | запись</br> [1:9] | поле</br> [9:11] | значение                  |
|:------------------------|:------------------|:-----------------|:--------------------------|
| N                       | 0x00000000        | 0x0000           | автоинкремент id          |
| 0x00                    | 0x00000001        | > 0              | todo: user private key    |
| N                       | 0x00000000        | > 0              | пользовательские ид полей |
| N                       | M                 | 0x0000           | `recordHeader`            |
| N                       | M                 | R                | значение поля             |

## TODO:

1. Пользователи, аутентификация 
2. Конфиги, запись/чтение данных на диск
3. Просмотр истории изменений 
4. Производительность/многозадачность
5. Рефакторинг/Ренэйминг
6. Контроль версий 
7. Администрирование

